{% extends "base.html" %}

{% block title %}
–ü—Ä–æ—Ñ—ñ–ª—å —Å—Ç—É–¥–µ–Ω—Ç–∞ - {{ student_profile.user.first_name }} {{ student_profile.user.last_name }}
{% endblock %}

{% block content %}
<div style="margin-top: 2rem;">
  <div class="d-flex justify-between align-center mb-3">
    <h1>üë®‚Äçüéì –ü—Ä–æ—Ñ—ñ–ª—å —Å—Ç—É–¥–µ–Ω—Ç–∞</h1>
    <a href="{% url 'searching:filter_teachers' %}" class="btn btn-primary">
      üîç –ü–æ—à—É–∫ –≤–∏–∫–ª–∞–¥–∞—á—ñ–≤
    </a>
  </div>

  <!-- Personal Information Card -->
  <div class="card">
    <div class="card-header">
      <h2 class="card-title">üìã –û—Å–æ–±–∏—Å—Ç–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è</h2>
    </div>
    <div class="card-body">
      <table style="width: 100%; border: none; box-shadow: none;">
        <tbody>
          <tr style="background: none;">
            <td style="border: none; font-weight: 600; width: 30%;">–ü–Ü–ë:</td>
            <td style="border: none;">{{ student_profile.user.first_name }} {{ student_profile.user.last_name }}</td>
          </tr>
          <tr style="background: none;">
            <td style="border: none; font-weight: 600;">Email:</td>
            <td style="border: none;">{{ student_profile.user.email }}</td>
          </tr>
          <tr style="background: none;">
            <td style="border: none; font-weight: 600;">–ì—Ä—É–ø–∞:</td>
            <td style="border: none;">{{ student_profile.group }}</td>
          </tr>
          <tr style="background: none;">
            <td style="border: none; font-weight: 600;">–ö—É—Ä—Å:</td>
            <td style="border: none;">{{ student_profile.get_year_of_study_display }}</td>
          </tr>
          {% if student_profile.specialization %}
          <tr style="background: none;">
            <td style="border: none; font-weight: 600;">–°–ø–µ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è:</td>
            <td style="border: none;">{{ student_profile.specialization }}</td>
          </tr>
          {% endif %}
          {% if student_profile.department %}
          <tr style="background: none;">
            <td style="border: none; font-weight: 600;">–ö–∞—Ñ–µ–¥—Ä–∞:</td>
            <td style="border: none;">{{ student_profile.department.name }}</td>
          </tr>
          {% endif %}
          {% if student_profile.course_topic %}
          <tr style="background: none;">
            <td style="border: none; font-weight: 600;">–¢–µ–º–∞ –∫—É—Ä—Å–æ–≤–æ—ó:</td>
            <td style="border: none;">{{ student_profile.course_topic }}</td>
          </tr>
          {% endif %}
        </tbody>
      </table>
    </div>
  </div>

  <!-- Supervisor Status Section -->
  {% if assigned_slot and teacher %}
  <!-- Assigned Teacher -->
  <div class="card">
    <div class="card-header">
      <h2 class="card-title">‚úÖ –ü—Ä–∏–∫—Ä—ñ–ø–ª–µ–Ω–∏–π –≤–∏–∫–ª–∞–¥–∞—á</h2>
      <span class="badge badge-success">–ó–∞—Ç–≤–µ—Ä–¥–∂–µ–Ω–æ</span>
    </div>
    <div class="card-body">
      <table style="width: 100%; border: none; box-shadow: none;">
        <tbody>
          <tr style="background: none;">
            <td style="border: none; font-weight: 600; width: 30%;">–í–∏–∫–ª–∞–¥–∞—á:</td>
            <td style="border: none;">{{ teacher.user.first_name }} {{ teacher.user.last_name }}</td>
          </tr>
          <tr style="background: none;">
            <td style="border: none; font-weight: 600;">Email:</td>
            <td style="border: none;">
              <a href="mailto:{{ teacher.user.email }}">{{ teacher.user.email }}</a>
            </td>
          </tr>
          {% if teacher.department %}
          <tr style="background: none;">
            <td style="border: none; font-weight: 600;">–ö–∞—Ñ–µ–¥—Ä–∞:</td>
            <td style="border: none;">{{ teacher.department.name }}</td>
          </tr>
          {% endif %}
          {% if teacher.position %}
          <tr style="background: none;">
            <td style="border: none; font-weight: 600;">–ü–æ—Å–∞–¥–∞:</td>
            <td style="border: none;">{{ teacher.position }}</td>
          </tr>
          {% endif %}
        </tbody>
      </table>
    </div>
    <div class="card-footer">
      <small class="text-muted">
        üí° –ó–≤'—è–∂—ñ—Ç—å—Å—è –∑ –≤–∏–∫–ª–∞–¥–∞—á–µ–º –¥–ª—è –ø–ª–∞–Ω—É–≤–∞–Ω–Ω—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ–π
      </small>
    </div>
  </div>

  {% elif active_request %}
  <!-- Pending Request -->
  <div class="card">
    <div class="card-header">
      <h2 class="card-title">‚è≥ –°—Ç–∞—Ç—É—Å –∑–∞–ø–∏—Ç—É</h2>
      {% if active_request.status == 'pending' %}
      <span class="badge badge-warning">{{ active_request.get_status_display }}</span>
      {% elif active_request.status == 'approved' %}
      <span class="badge badge-success">{{ active_request.get_status_display }}</span>
      {% elif active_request.status == 'rejected' %}
      <span class="badge badge-danger">{{ active_request.get_status_display }}</span>
      {% endif %}
    </div>
    <div class="card-body">
      <p><strong>–í–∏–∫–ª–∞–¥–∞—á:</strong> {{ active_request.slot.teacher.user.first_name }} {{
        active_request.slot.teacher.user.last_name }}</p>
      <p><strong>Email:</strong> {{ active_request.slot.teacher.user.email }}</p>
      <p class="text-muted">
        {% if active_request.status == 'pending' %}
        –í–∞—à –∑–∞–ø–∏—Ç –æ—á—ñ–∫—É—î –Ω–∞ —Ä–æ–∑–≥–ª—è–¥ –≤–∏–∫–ª–∞–¥–∞—á–µ–º
        {% elif active_request.status == 'rejected' %}
        –ù–∞ –∂–∞–ª—å, –≤–∞—à –∑–∞–ø–∏—Ç –±—É–ª–æ –≤—ñ–¥—Ö–∏–ª–µ–Ω–æ. –°–ø—Ä–æ–±—É–π—Ç–µ –æ–±—Ä–∞—Ç–∏ —ñ–Ω—à–æ–≥–æ –≤–∏–∫–ª–∞–¥–∞—á–∞.
        {% endif %}
      </p>
    </div>
    {% if active_request.status == 'rejected' %}
    <div class="card-footer">
      <a href="{% url 'searching:filter_teachers' %}" class="btn btn-primary btn-sm">
        –û–±—Ä–∞—Ç–∏ —ñ–Ω—à–æ–≥–æ –≤–∏–∫–ª–∞–¥–∞—á–∞
      </a>
    </div>
    {% endif %}
  </div>

  {% else %}
  <!-- No Teacher Selected -->
  <div class="card">
    <div class="card-header">
      <h2 class="card-title">‚ùå –ö–µ—Ä—ñ–≤–Ω–∏–∫ –Ω–µ –æ–±—Ä–∞–Ω–∏–π</h2>
    </div>
    <div class="card-body text-center" style="padding: 3rem 2rem;">
      <p style="font-size: 1.125rem; margin-bottom: 2rem;">
        –í–∏ —â–µ –Ω–µ –æ–±—Ä–∞–ª–∏ –Ω–∞—É–∫–æ–≤–æ–≥–æ –∫–µ—Ä—ñ–≤–Ω–∏–∫–∞ –¥–ª—è –≤–∞—à–æ—ó –∫—É—Ä—Å–æ–≤–æ—ó —Ä–æ–±–æ—Ç–∏
      </p>
      <a href="{% url 'searching:filter_teachers' %}" class="btn btn-primary btn-lg">
        üîç –û–±—Ä–∞—Ç–∏ –≤–∏–∫–ª–∞–¥–∞—á–∞ –∑–∞—Ä–∞–∑
      </a>
    </div>
    <div class="card-footer text-center">
      <small class="text-muted">
        üí° –ü–æ—Ä–∞–¥–∞: –û–±–µ—Ä—ñ—Ç—å –≤–∏–∫–ª–∞–¥–∞—á–∞, —á–∏—è —Å–ø–µ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î —Ç–µ–º—ñ –≤–∞—à–æ—ó —Ä–æ–±–æ—Ç–∏
      </small>
    </div>
  </div>
  {% endif %}

  <!-- Quick Actions -->
  <div class="card-grid" style="margin-top: 2rem;">
    <div class="card">
      <div class="card-body text-center">
        <h3 style="font-size: 1.25rem; margin-bottom: 1rem;">üîç –ü–æ—à—É–∫ –≤–∏–∫–ª–∞–¥–∞—á—ñ–≤</h3>
        <p class="text-muted mb-3">–ó–Ω–∞–π–¥—ñ—Ç—å –≤–∏–∫–ª–∞–¥–∞—á–∞ –∑–∞ —Å–ø–µ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—î—é</p>
        <a href="{% url 'searching:filter_teachers' %}" class="btn btn-secondary">–ü–µ—Ä–µ–π—Ç–∏ –¥–æ –ø–æ—à—É–∫—É</a>
      </div>
    </div>

    <div class="card">
      <div class="card-body text-center">
        <h3 style="font-size: 1.25rem; margin-bottom: 1rem;">üè† –ì–æ–ª–æ–≤–Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞</h3>
        <p class="text-muted mb-3">–ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è –Ω–∞ –≥–æ–ª–æ–≤–Ω—É</p>
        <a href="{% url 'home' %}" class="btn btn-outline">–ù–∞ –≥–æ–ª–æ–≤–Ω—É</a>
      </div>
    </div>
  </div>
</div>
{% endblock %}