{% extends "base.html" %}

{% block title %}{{ teacher.user.first_name }} {{ teacher.user.last_name }} - –ü—Ä–æ—Ñ—ñ–ª—å –≤–∏–∫–ª–∞–¥–∞—á–∞{% endblock %}

{% block content %}
<div style="margin-top: 2rem;">
  <h1>üë®‚Äçüè´ {{ teacher.user.first_name }} {{ teacher.user.last_name }}</h1>

  <!-- Teacher Information Card -->
  <div class="card">
    <div class="card-header">
      <h2 class="card-title">üìã –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –≤–∏–∫–ª–∞–¥–∞—á–∞</h2>
    </div>
    <div class="card-body">
      <table style="width: 100%; border: none; box-shadow: none;">
        <tbody>
          <tr style="background: none;">
            <td style="border: none; font-weight: 600; width: 30%;">Email:</td>
            <td style="border: none;"><a href="mailto:{{ teacher.user.email }}">{{ teacher.user.email }}</a></td>
          </tr>
          {% if teacher.department %}
          <tr style="background: none;">
            <td style="border: none; font-weight: 600;">–ö–∞—Ñ–µ–¥—Ä–∞:</td>
            <td style="border: none;">{{ teacher.department.name }}</td>
          </tr>
          {% endif %}
          {% if teacher.bio %}
          <tr style="background: none;">
            <td style="border: none; font-weight: 600;">–ü—Ä–æ —Å–µ–±–µ:</td>
            <td style="border: none;">{{ teacher.bio }}</td>
          </tr>
          {% endif %}
          {% if teacher.scientific_interests.all %}
          <tr style="background: none;">
            <td style="border: none; font-weight: 600;">–ù–∞—É–∫–æ–≤—ñ —ñ–Ω—Ç–µ—Ä–µ—Å–∏:</td>
            <td style="border: none;">
              {% for interest in teacher.scientific_interests.all %}
              <span class="badge badge-primary">{{ interest.name }}</span>
              {% endfor %}
            </td>
          </tr>
          {% endif %}
          <tr style="background: none;">
            <td style="border: none; font-weight: 600;">–î–æ—Å—Ç—É–ø–Ω—ñ—Å—Ç—å:</td>
            <td style="border: none;">
              <strong>{{ teacher.available_slots_count }}</strong> –∑ <strong>{{ teacher.total_slots_count }}</strong>
              —Å–ª–æ—Ç—ñ–≤ –≤—ñ–ª—å–Ω–æ
              {% if teacher.available_slots_count > 0 %}
              <span class="badge badge-success">–î–æ—Å—Ç—É–ø–Ω–∏–π</span>
              {% else %}
              <span class="badge badge-warning">–ù–µ–º–∞—î –≤—ñ–ª—å–Ω–∏—Ö –º—ñ—Å—Ü—å</span>
              {% endif %}
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Request Status or Form -->
  {% if active_request %}
  <div class="card">
    <div class="card-header">
      <h2 class="card-title">‚è≥ –°—Ç–∞—Ç—É—Å –∑–∞–ø–∏—Ç—É</h2>
      {% if active_request.status == 'pending' %}
      <span class="badge badge-warning">{{ active_request.get_status_display }}</span>
      {% elif active_request.status == 'approved' %}
      <span class="badge badge-success">{{ active_request.get_status_display }}</span>
      {% elif active_request.status == 'rejected' %}
      <span class="badge badge-danger">{{ active_request.get_status_display }}</span>
      {% endif %}
    </div>
    <div class="card-body">
      <p>
        {% if active_request.status == 'pending' %}
        –í–∞—à –∑–∞–ø–∏—Ç –æ—á—ñ–∫—É—î –Ω–∞ —Ä–æ–∑–≥–ª—è–¥ –≤–∏–∫–ª–∞–¥–∞—á–µ–º
        {% elif active_request.status == 'approved' %}
        –í—ñ—Ç–∞—î–º–æ! –í–∏–∫–ª–∞–¥–∞—á –ø—ñ–¥—Ç–≤–µ—Ä–¥–∏–≤ –≤–∞—à –∑–∞–ø–∏—Ç
        {% elif active_request.status == 'rejected' %}
        –ù–∞ –∂–∞–ª—å, –≤–∞—à –∑–∞–ø–∏—Ç –±—É–ª–æ –≤—ñ–¥—Ö–∏–ª–µ–Ω–æ
        {% endif %}
      </p>
    </div>
  </div>

  {% elif has_assigned_slot %}
  <div class="card">
    <div class="card-header">
      <h2 class="card-title">‚úÖ –í–∏ –≤–∂–µ –ø—Ä–∏–∫—Ä—ñ–ø–ª–µ–Ω—ñ</h2>
    </div>
    <div class="card-body">
      <p>–í–∏ –≤–∂–µ –ø—Ä–∏–∫—Ä—ñ–ø–ª–µ–Ω—ñ –¥–æ —Ü—å–æ–≥–æ –≤–∏–∫–ª–∞–¥–∞—á–∞. –î–ª—è –∑–º—ñ–Ω–∏ –≤–∏–∫–ª–∞–¥–∞—á–∞ –∑–≤–µ—Ä–Ω—ñ—Ç—å—Å—è –¥–æ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ü—ñ—ó.</p>
    </div>
  </div>

  {% elif can_send_request and first_available_slot %}
  <div class="card">
    <div class="card-header">
      <h2 class="card-title">üì® –ù–∞–¥—ñ—Å–ª–∞—Ç–∏ –∑–∞–ø–∏—Ç –Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ—é</h2>
    </div>
    <div class="card-body">
      <form method="post" action="{% url 'searching:send_request' first_available_slot.id %}">
        {% csrf_token %}
        <div class="form-group">
          <label for="message">–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤–∏–∫–ª–∞–¥–∞—á—É (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)</label>
          <textarea name="message" id="message" rows="4"
            placeholder="–†–æ–∑–∫–∞–∂—ñ—Ç—å –∫–æ—Ä–æ—Ç–∫–æ –ø—Ä–æ —Ç–µ–º—É –≤–∞—à–æ—ó —Ä–æ–±–æ—Ç–∏ —Ç–∞ —á–æ–º—É –æ–±—Ä–∞–ª–∏ —Ü—å–æ–≥–æ –≤–∏–∫–ª–∞–¥–∞—á–∞..."></textarea>
          <span class="form-help">–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–æ–ø–æ–º–æ–∂–µ –≤–∏–∫–ª–∞–¥–∞—á—É –∫—Ä–∞—â–µ –∑—Ä–æ–∑—É–º—ñ—Ç–∏ –≤–∞—à—É –º–æ—Ç–∏–≤–∞—Ü—ñ—é</span>
        </div>
        <button type="submit" class="btn btn-primary btn-lg" style="width: 100%;">
          ‚úâÔ∏è –ù–∞–¥—ñ—Å–ª–∞—Ç–∏ –∑–∞–ø–∏—Ç
        </button>
      </form>
    </div>
  </div>

  {% else %}
  <div class="card">
    <div class="card-header">
      <h2 class="card-title">‚ùå –ù–µ–º–∞—î –≤—ñ–ª—å–Ω–∏—Ö —Å–ª–æ—Ç—ñ–≤</h2>
    </div>
    <div class="card-body text-center" style="padding: 2rem;">
      <p class="text-muted">–ù–∞ –∂–∞–ª—å, —É —Ü—å–æ–≥–æ –≤–∏–∫–ª–∞–¥–∞—á–∞ –∑–∞—Ä–∞–∑ –Ω–µ–º–∞—î –≤—ñ–ª—å–Ω–∏—Ö –º—ñ—Å—Ü—å –¥–ª—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ–π.</p>
      <a href="{% url 'searching:filter_teachers' %}" class="btn btn-secondary mt-3">
        –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ —ñ–Ω—à–∏—Ö –≤–∏–∫–ª–∞–¥–∞—á—ñ–≤
      </a>
    </div>
  </div>
  {% endif %}

  <!-- Back Button -->
  <div style="margin-top: 2rem;">
    <a href="{% url 'searching:filter_teachers' %}" class="btn btn-outline">‚Üê –ù–∞–∑–∞–¥ –¥–æ –ø–æ—à—É–∫—É</a>
  </div>
</div>
{% endblock %}