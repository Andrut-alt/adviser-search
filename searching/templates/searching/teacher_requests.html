{% extends "base.html" %}

{% block title %}–ó–∞–ø–∏—Ç–∏ –≤—ñ–¥ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ - Mentorion{% endblock %}

{% block content %}
<div style="margin-top: 2rem;">
  <h1>üì® –ó–∞–ø–∏—Ç–∏ –≤—ñ–¥ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤</h1>
  <p class="text-muted mb-4">–ü–µ—Ä–µ–≥–ª—è–¥ —Ç–∞ –æ–±—Ä–æ–±–∫–∞ –∑–∞–ø–∏—Ç—ñ–≤ –Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ—ó</p>

  {% if requests %}
  <div class="table-responsive">
    <table>
      <thead>
        <tr>
          <th>–°—Ç—É–¥–µ–Ω—Ç</th>
          <th>–ö—É—Ä—Å</th>
          <th>–¢–µ–º–∞ –∫—É—Ä—Å–æ–≤–æ—ó</th>
          <th>–°—Ç–∞—Ç—É—Å</th>
          <th>–î–∞—Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è</th>
          <th>–î—ñ—ó</th>
        </tr>
      </thead>
      <tbody>
        {% for req in requests %}
        <tr>
          <td>
            <strong>{{ req.student.user.first_name }} {{ req.student.user.last_name }}</strong><br>
            <small class="text-muted">{{ req.student.user.email }}</small>
          </td>
          <td>{{ req.student.get_year_of_study_display }}</td>
          <td>{{ req.student.course_topic|default:"–ù–µ –≤–∫–∞–∑–∞–Ω–æ" }}</td>
          <td>
            {% if req.status == 'pending' %}
            <span class="badge badge-warning">{{ req.get_status_display }}</span>
            {% elif req.status == 'approved' %}
            <span class="badge badge-success">{{ req.get_status_display }}</span>
            {% elif req.status == 'rejected' %}
            <span class="badge badge-danger">{{ req.get_status_display }}</span>
            {% endif %}
          </td>
          <td>{{ req.created_at|date:"d.m.Y H:i" }}</td>
          <td>
            {% if req.status == 'pending' %}
            {% if not req.slot.is_filled %}
            <a href="{% url 'searching:approve_request' req.id %}" class="btn btn-success btn-sm">‚úÖ –ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏</a>
            <a href="{% url 'searching:reject_request' req.id %}" class="btn btn-danger btn-sm">‚ùå –í—ñ–¥—Ö–∏–ª–∏—Ç–∏</a>
            {% else %}
            <span class="badge">–°–ª–æ—Ç –∑–∞–π–Ω—è—Ç–∏–π</span>
            {% endif %}
            {% else %}
            <span class="text-muted">‚Äî</span>
            {% endif %}
          </td>
        </tr>
        {% if req.message %}
        <tr style="background: var(--color-background);">
          <td colspan="6" style="padding: 1rem;">
            <strong>üí¨ –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è:</strong> {{ req.message }}
          </td>
        </tr>
        {% endif %}
        {% endfor %}
      </tbody>
    </table>
  </div>

  {% else %}
  <div class="card">
    <div class="card-body text-center" style="padding: 3rem;">
      <h3 style="color: var(--color-text-secondary); margin-bottom: 1rem;">üì≠ –ó–∞–ø–∏—Ç—ñ–≤ –Ω–µ–º–∞—î</h3>
      <p class="text-muted">–ö–æ–ª–∏ —Å—Ç—É–¥–µ–Ω—Ç–∏ –Ω–∞–¥—ñ—à–ª—é—Ç—å –∑–∞–ø–∏—Ç–∏ –Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ—ó, –≤–æ–Ω–∏ –∑'—è–≤–ª—è—Ç—å—Å—è —Ç—É—Ç</p>
    </div>
  </div>
  {% endif %}

  <!-- Back Button -->
  <div style="margin-top: 2rem;">
    <a href="{% url 'profiles:teacher_profile' %}" class="btn btn-outline">‚Üê –ù–∞–∑–∞–¥ –¥–æ –ø—Ä–æ—Ñ—ñ–ª—é</a>
  </div>
</div>
{% endblock %}