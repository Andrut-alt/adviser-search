{% extends "base.html" %}

{% block title %}Мої слоти - Mentorion{% endblock %}

{% block content %}
<div style="margin-top: 2rem;">
  <h1> Мої слоти</h1>

  <!-- Statistics -->
  <div class="card mb-4">
    <div class="card-body">
      <div class="d-flex gap-3" style="justify-content: space-around; text-align: center;">
        <div>
          <div style="font-size: 2rem; font-weight: bold; color: var(--color-primary);">{{ slots.count }}</div>
          <div class="text-muted">Поточних слотів</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Slots List -->
  <h2 class="mb-3">Список слотів</h2>

  {% if slots %}
  <div style="display: flex; flex-direction: column; gap: 1rem;">
    {% for slot in slots %}
    <div class="card"
      style="border-left: 4px solid {% if slot.is_filled %}var(--color-error){% else %}var(--color-success){% endif %};">
      <div class="card-header">
        <div class="d-flex justify-between align-center">
          <h3 class="card-title" style="margin: 0;">Слот #{{ slot.id }}</h3>
          {% if slot.is_filled %}
          <span class="badge badge-danger">Зайнятий</span>
          {% else %}
          <span class="badge badge-success">Вільний</span>
          {% endif %}
        </div>
      </div>
      <div class="card-body">
        {% if slot.student %}
        <table style="width: 100%; border: none; box-shadow: none;">
          <tbody>
            <tr style="background: none;">
              <td style="border: none; font-weight: 600; width: 25%;">Студент:</td>
              <td style="border: none;">{{ slot.student.user.first_name }} {{ slot.student.user.last_name }}</td>
            </tr>
            <tr style="background: none;">
              <td style="border: none; font-weight: 600;">Email:</td>
              <td style="border: none;"><a href="mailto:{{ slot.student.user.email }}">{{ slot.student.user.email }}</a>
              </td>
            </tr>
            <tr style="background: none;">
              <td style="border: none; font-weight: 600;">Курс:</td>
              <td style="border: none;">{{ slot.student.get_year_of_study_display }}</td>
            </tr>
            {% if slot.student.course_topic %}
            <tr style="background: none;">
              <td style="border: none; font-weight: 600;">Тема курсової:</td>
              <td style="border: none;">{{ slot.student.course_topic }}</td>
            </tr>
            {% endif %}
          </tbody>
        </table>
        {% else %}
        <p class="text-muted">Слот вільний для бронювання студентами</p>
        {% endif %}
        <p class="text-muted mb-0" style="margin-top: 1rem;">
          <small> Створено: {{ slot.created_at|date:"d.m.Y H:i" }}</small>
        </p>
      </div>
      <div class="card-footer">
        <a href="{% url 'searching:slot_detail' slot.id %}" class="btn btn-secondary btn-sm">Переглянути деталі</a>
      </div>
    </div>
    {% endfor %}
  </div>

  {% else %}
  <div class="card">
    <div class="card-body text-center" style="padding: 3rem;">
      <h3 style="color: var(--color-text-secondary); margin-bottom: 1rem;"> Слотів немає</h3>
      <p class="text-muted mb-3">Слоти буде створено адміністратором</p>
    </div>
  </div>
  {% endif %}

  <!-- Back Button -->
  <div style="margin-top: 2rem;">
    <a href="{% url 'profiles:teacher_profile' %}" class="btn btn-outline">← Назад до профілю</a>
  </div>
</div>
{% endblock %}